| **No.** | **SQL Query**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| :-----: | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|  **1**  | `sql<br>SELECT AVG(reward_gold) AS mean_reward_gold<br>FROM questboard;`                                                                                                                                                                                                                                                                                                                                                                                                                              |
|  **2**  | `sql<br>SELECT COUNT(*) AS creature_count<br>FROM mystical_creature<br>WHERE power_level < 200;`                                                                                                                                                                                                                                                                                                                                                                                                      |
|  **3**  | `sql<br>SELECT COUNT(*) AS quest_count<br>FROM questboard<br>WHERE reward_gold BETWEEN 1000 AND 2000;`                                                                                                                                                                                                                                                                                                                                                                                                |
|  **4**  | `sql<br>SELECT SUM(quantity) AS total_quantity<br>FROM potion_transaction_shop<br>WHERE potion_rarity_code = 4;`                                                                                                                                                                                                                                                                                                                                                                                      |
|  **5**  | `sql<br>SELECT PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY power_level) AS first_quartile<br>FROM mystical_creature;`                                                                                                                                                                                                                                                                                                                                                                                |
|  **6**  | `sql<br>SELECT AVG(unit_price) AS avg_unit_price<br>FROM potion_transaction_shop<br>WHERE shop_level = 10;`                                                                                                                                                                                                                                                                                                                                                                                           |
|  **7**  | `sql<br>-- For median<br>SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY loyalty_score) AS median_loyalty<br>FROM mystical_creature;<br><br>-- For percentage above median<br>WITH median_calc AS (<br>    SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY loyalty_score) AS median_val<br>    FROM mystical_creature<br>)<br>SELECT <br>    COUNT(CASE WHEN loyalty_score > median_calc.median_val THEN 1 END) * 100.0 / COUNT(*) AS pct_above_median<br>FROM mystical_creature, median_calc;` |
|  **8**  | `sql<br>SELECT STDDEV(reward_gold + reward_experience) AS reward_value_stddev<br>FROM questboard<br>WHERE quest_priority = 1;`                                                                                                                                                                                                                                                                                                                                                                        |
|  **9**  | `sql<br>SELECT <br>    SUM(potion_strength * quantity) * 1.0 / SUM(quantity) AS weighted_avg_strength<br>FROM potion_transaction_shop;`                                                                                                                                                                                                                                                                                                                                                               |
| **10**  | `sql<br>WITH regional_percentiles AS (<br>    SELECT <br>        region_id,<br>        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY power_level) AS p75_power<br>    FROM mystical_creature<br>    GROUP BY region_id<br>)<br>SELECT MAX(p75_power) AS max_75th_percentile<br>FROM regional_percentiles;`                                                                                                                                                                                             |
| **11**  | `sql<br>SELECT <br>    creature_species,<br>    AVG(power_level) AS avg_power_level<br>FROM mystical_creature<br>GROUP BY creature_species<br>ORDER BY avg_power_level DESC<br>LIMIT 1;`                                                                                                                                                                                                                                                                                                              |
| **12**  | `sql<br>WITH quartiles AS (<br>    SELECT <br>        PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY unit_price) AS q1,<br>        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY unit_price) AS q3<br>    FROM potion_transaction_shop<br>    WHERE shop_level = 10<br>)<br>SELECT q3 - q1 AS iqr<br>FROM quartiles;`                                                                                                                                                                                    |
| **13**  | `sql<br>SELECT <br>    SUM(quantity * unit_price) AS total_transaction_value<br>FROM potion_transaction_shop<br>WHERE owner_id % 10 = 7;`                                                                                                                                                                                                                                                                                                                                                             |
| **14**  | `sql<br>WITH top5 AS (<br>    SELECT creature_name, age_years, loyalty_score, power_level<br>    FROM mystical_creature<br>    ORDER BY power_level DESC<br>    LIMIT 5<br>)<br>SELECT <br>    VAR_POP(power_level) AS variance,<br>    ARRAY_AGG(creature_name) AS names,<br>    ARRAY_AGG(age_years) AS ages,<br>    ARRAY_AGG(loyalty_score) AS loyalty_scores<br>FROM top5;`                                                                                                                      |
| **15**  | `sql<br>WITH avg_prob AS (<br>    SELECT AVG(quest_success_probability) AS avg_val<br>    FROM questboard<br>),<br>below_avg AS (<br>    SELECT POWER(quest_success_probability - avg_prob.avg_val, 2) AS squared_deviation<br>    FROM questboard, avg_prob<br>    WHERE quest_success_probability < avg_prob.avg_val<br>)<br>SELECT AVG(squared_deviation) AS downside_semi_variance<br>FROM below_avg;`                                                                                            |
